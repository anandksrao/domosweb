<a name='top'></a>

<div style="margin-top: 20px;">
<div class="container">
<div class='row'>
  <div class='span12'>
   <%= link_to (image_tag '/assets/domosaics_banner.png', :alt=>'DoMosaicS'), 'http://www.domosaics.uni-muenster.de' %>
    <div class='btn-toolbar'>
      <div class="btn-group">
         <a class="btn" href='#requirements'>Requirements</a>
         <a class='btn btn-success' href='#download'>Download</a>
         <a class='btn' href='#usage'>Using</a>
         <a class='btn' href='#changelog'>Changelog</a>
         <a class='btn' href='#faq'>FAQ</a>
         <%= link_to "Documentation", page_path("docs/index.html"), :class => 'btn' %>
         <a class='btn' href='#referencing'>Referencing</a>
         <a class='btn' href='#contact'>Contact</a>
      </div>
    </div>
  </div>
</div>
  <section id='about'>
  <a name="about"></a>
  <h3>About</h3>
  <hr />
  <div class='row'>
  <div class='span12'>
    <div style='text-align:justify;'>DoMosaics (previously known as <b>AnGSTD</b>) shows you a tree with corresponding domain arrangements of the
  proteins at the same time.  If you want to know where your domain was lost,
  whether a group of proteins differs in its domain arrangements, or what are
  the characteristic domains for a phylogenetic group, DoMosaics is for you.
  DoMosaics lets you also examine the domain annotations to see whether the
  domains have been correctly identified. You can create dotplots, run a
  context-dependent similarity analysis and more.
  Furthermore, you can also run some general phylogenetic profiling, create
  domain network graphs, find domain insertion/deletion events and, last but
  not least, simply visualize and manipulate phylogenetic trees.
  All output can be saved as PDF or as SVG (which can be viewed
  in Firefox or edited using e.g. Adobe Illustrator or <a href="http://www.inkscape.org">Inkscape</a>)
  as well as in a number of common bitmap formats.</div>
  </div>
  <div class='span8'>
    <dl class="dl-horizontal">
    <dt>Graphics</dt>
    <dd>create highly customizable, publication ready graphics from annotation data</dd>
    <dt>Annotate</dt>
    <dd>easy-to-use batch access to InterPro, wrapper for local HMMER installation</dd>
    <dt>Connect data</dt>
    <dd>visualize domain architectures along phylogenies</dd>
    <dt>Analyse</dt>
    <dd>investigate domain gain and loss events along branches, collapse similar architectures, annotate domains with context, perform domain dotplots, 
    access webservices @EBI, ...</dd>
    <dt>Manage</dt>
    <dd>manage multiple projects in parallel, merge projects, export selections to new projects, separate data types in different views, ...</dd>
  </div>
  </div> 
  <p>
  <span class="label label-important">NOTE:</span> We will release DoMosaics to the public domain, and source code
  will be made available on github after we have released the first stable version.
  </p>
  </section>

<!--
  <section id='screenshots'>
  <ul class="thumbnails">
        <li class="span4">
          <div class='thumbnail'>
            <a href="/assets/domos-screen1.png"><img src="/assets/domos-screen1_thumb.png" alt=""></a>
            <div class='caption'>
            <h5>Arrangement comparison</h5>
            <p>Annotate input sequences using InterPro and tailor the architecture appearance to your needs</p>
            </div>
          </div>
        </li>

        <li class="span4">
          <div class='thumbnail'>
            <img src="/assets/domos-screen1_thumb.png" alt="">
            <div class='caption'>
            <h5>Arrangement comparison<h5>
            <p>Annotate input sequences using InterPro</p>
            </div>
          </div>
        </li>

        <li class="span4">
          <div class='thumbnail'>
            <img src="/assets/domos-screen1_thumb.png" alt="">
            <div class='caption'>
            <h5>Arrangement comparison<h5>
            <p>Annotate input sequences using InterPro</p>
            </div>
          </div>
        </li>
      </ul>
  </section>
-->

  <a name="requirements"></a>
  <section='requirements'>
  <h3>Requirements</h3>
  <hr />
  <div class='row'>
    <div class='span6'>
      <p style='text-align:justify;'>Any machine running <a href="http://java.com/en">Sun Java 6</a> should be able to run DoMosaics. RAM requirements vary depending on data set size, but we recommend 512 MB RAM.
      For running HMMSCAN, a dual core (or better) is recommended. If you should encounter any issues, please let us know. You can download
      the jar below (for which a sign-up is currently required)</p>
    </div>
    <div class='span6'>
      <div class="alert alert-info">
      <b>Software links</b>:
      <ul>
        <li><a href="http://java.com/en">http://java.com</a></li>
        <li><a href="http://hmmer.janelia.org">http://hmmer.janelia.org</a></li>
        <li><a href="http://www.ebi.ac.uk/interpro/">http://www.ebi.ac.uk/interpro/</a></li>
      </ul>
      <b>Domain models</b>:
      <ul>
        <li><a href="http://pfam.sanger.ac.uk/">http://pfam.sanger.ac.uk/</a></li>
        <li><a href="http://smart.embl-heidelberg.de/">http://smart.embl-heidelberg.de/</a></li>
        <li><a href="http://supfam.cs.bris.ac.uk/SUPERFAMILY/">http://supfam.cs.bris.ac.uk/SUPERFAMILY/</a></li>
      </ul>
      </div>
    </div>
  </div>
  <p style='float:right;'><a class='btn btn-small btn-info' href='#top'>top <i class="icon-arrow-up"></i></a></p>
  <br />
  <br />
  </section>

  <a name="download"></a>
  <section id="download">
  <h3>Download</h3>
  <hr />
    <!---
  <div class="alert" style='text-align: center';>
    <b>Warning</b>: The download of DoMosaics is currently disabled while we move the web application, update the binaries
    and installers. We plan to complete all updates by <b>Friday, 31 of May</b>.
        If need be, you can get the latest build <%= link_to 'here', "/builds/development/current_build.jar" %>(jar file).
  </div>
  -->
  <div class='row'>
    <div class='span8'>
      <div id='notification_field'></div>
      <div class="tabbable">
        <ul class="nav nav-tabs">
          <li class="active"><a href="#tab0" data-toggle="tab">Java web start</a></li>
          <li><a href="#tab1" data-toggle="tab">Sign up for news</a></li>
          <li><a href="#tab3" data-toggle="tab">Direct download</a></li>
        </ul>
        <div class="tab-content">

          <div class="tab-pane active" id="tab0">
            <script src="http://java.com/js/deployJava.js"></script>
            <script>
                function launchJNLP(mem, offline) {
                    var minVer = '1.6';
                    var jnlp = 'builds/jnlp/domosaics-'+mem+'-'+offline+'.jnlp';
                    alert("selected JNLP: "+jnlp)
                    if ( !deployJava.isWebStartInstalled(minVer) ){
                        if ( deployJava.installLatestJRE() ){
                            if ( deployJava.launch(jnlp) ){ }
                        }
                    }
                    else {
                        if( deployJava.launch(jnlp) ){ }
                    }
                }
            </script>
            <% image_tag "java_logo.png" %>
            <div class="well">
            DoMosaics requires an up-to-date version of Java. Once installed, you can
            start DoMosaics using JAVA web start by clicking Start DoMosaics below.
            For most applications, the default memory settings should be sufficient.
            If you choose to enable the offline-mode, a link to the cached jar will
            be placed on your desktop and in your start menu. Find out more about
            Java Web Start <a href="http://docs.oracle.com/javase/tutorial/deployment/webstart/">here</a>.
            </div>

            <div class='pull-left'>
                <%= image_tag "java_logo.png" %>
            </div>


            <div class="pull-left">
              <div class="form-horizontal">

                <div class="control-group">
                  <label class="control-label" for="JVMmem">JVM size</label>
                  <div class="controls">
                    <div class='input-append'>
                    <select class='input-small span2' id='JVMmem'>
                      <option></option>
                      <option value='500'>500</option>
                      <option selected='true' value='1000'>1000</option>
                      <option value='1500'>1500</option>
                      <option value='2000'>2000</option>
                      <option value='2500'>2500</option>
                    </select>
                    <span class="add-on">MB</span>
                    </div>
                    <span class="help-block">The amount of memory allocated to the Java Virtual Machine</span>

                  </div>
                </div>

                <div class="control-group">
                  <label class="control-label" for="offline">Run offline</label>
                  <div class="controls">
                    <select class='span2' id='offline'>
                      <option value='S' selected="true">enabled</option>
                      <option value='NS'>disabled</option>
                    </select>
                    <span class="help-block">Indicates whether the program will run when offline</span>
                  </div>
                </div>

                <div class="control-group">
                  <div class="controls">
                    <button type='submit' class="btn btn-warning" onclick="launchJNLP( $('#JVMmem').val(), $('#offline').val())">Start DoMosaics</button>
                  </div>
                </div>
              </div>


            </div>
          </div>

          <div class="tab-pane" id="tab1">
            <%= render :partial => 'signup_form' %>
          </div>

          <div class="tab-pane" id="tab2">
            <%= form_tag 'users/resend_token', :class=>'well form-search', :remote => true, :id => 'resendform' do %>
              <%= text_field_tag :email, nil, :class=>"input-xlarge", :required => true, :type => 'email', :placeholder =>'Your email' %>
              <%= submit_tag 'resend email', :class => "btn btn-primary", :disabled => 'disabled', :disable_with => 'Sending...' %>
              <span class="help-block">Email you used for signing-up</span>
            <% end %>
          </div>
          <div class="tab-pane" id="tab3">
              <b>By downloading this software, you agree with the following:</b>
              <p style='text-align:justify;'>
                THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
                ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED 
                WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
                IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, 
                INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT 
                NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR 
                PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
                WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) 
                ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY 
                OF SUCH DAMAGE.  
              </p>
              <p style='text-align:justify;'><span class="label label-important">Note</span>:
                DoMosaics is licensed using the Apache License 2.0. For more information, please
                visit</p>
              <p style='text-align:center;'>
                <%= link_to "http://www.apache.org/licenses/LICENSE-2.0", "http://www.apache.org/licenses/LICENSE-2.0" %>
              </p>
            <table class="table">
              <thead>
              <tr>
                <th>Description</th>
                <th>Type</th>
                <th>Version</th>
                <th>Location</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>JAR</td>
                <td>Binary</td>
                <td>rv 1.82</td>
                <td><%= link_to "http://iebservices.uni-muenster.de/domosaics/download/domosaics.jar", "http://iebservices.uni-muenster.de/domosaics/download/domosaics.jar" %></td>
              </tr>
              <tr>
                <td>TAR</td>
                <td>source files</td>
                <td>rv 1.82</td>
                <td><%= link_to "http://iebservices.uni-muenster.de/domosaics/download/domosaics-src.tgz", "http://iebservices.uni-muenster.de/domosaics/download/domosaics-src.tgz" %></td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class='span4' style='padding-top:50px;'>
      <p style='text-align:justify;'>Use JAVA web start to start the application.
        JAVA web start allows users to start Java applications from a web server.
        It also makes sure that the application is always on the latest version.
        Note that, prior to running DoMosaics, your JAVA version we be checked
        (and you will be redirect to the JAVA download page if none, or an insufficient version of JAVA was detected).
        You can sign up with a valid email to receive update information.</p>
       <p style='text-align:justify;'><span class="label label-important">Important</span> We will 
        not use your email for anything but to send you a download link.</p>
       <p style='text-align:justify;'>You can also access the JAVA archive directly, or build
         DoMosaics from scratch by downloading the source files. We plan to release DoMosaics
         on GitHub in the nearer future. If you wish to contribute, please get in touch and we will
         can set you up with git read access</b>.</p>
    </div>
  </div>
  <p style='float:right;'><a class='btn btn-small btn-info' href='#top'>top <i class="icon-arrow-up"></i></a></p>
  <br />
  <br />
  </section>

  <a name='usage'></a>
  <section='usage'>
  <h3>Running DoMosaics</h3>
  <div style='text-align: justify;'>
  <hr />
  <p style='text-align:justify;'>
  To run DoMosaics, click on <b>Start DoMosaics</b> above. DoMosaics requires JAVA 1.7.
  Your browser will download a <abbr title="Java Network Launching Protocol">JNLP</abbr> file. Depending on your browser version and the availability of a JAVA plugin
  you should see a dialog indicating the progress of the download. After the download has completed, you will need to accept the permission level (and risk - see below).
    <section id='screenshots'>
      <ul class="thumbnails">
        <li class="span4">
          <div class='thumbnail'>
            <img src="/assets/installation/jws_download_app.png" alt="">
            <div class='caption'>
              <p>Downloading the DoMosaics JNLP file on Linux</p>
            </div>
          </div>
        </li>

        <li class="span4">
          <div class='thumbnail'>
            <img src="/assets/installation/webstart_warning.png" alt="">
            <p>The security warning on Windows</p>
          </div>
        </li>
      <li class="span4">
        <div class="alert alert-error">
          <b>Note</b>: DoMosaics will ask for unrestricted access to your system. This is necessary to allow proper interaction with your system
          (e.g. starting jobs, writing files etc). That said, we guarantee that DoMosaics will not do anything hidden or harmful to your system
          in any way.
        </div>
      </li>
    </ul>
    </section>
  If you enabled the offline mode above, you should see a DoMosaics Icon on your desktop (and in your start menu). There is no installation
  (or deinstallation) necessary as the link points to a self contained java archive. When you are done with the application, you can simply delete
  the link.
    <!--
  If you prefer using the command line, run the following to start DoMosaics
  <pre>[12:59] radmoore@joshua ~/Desktop $ javaws http://www.domosaics.net/builds/jnlp/domosaics/domosaics-1000-S.jnlp/</pre>
  this will require that you have correctly installed java web start. For more information on command line options, consult
  < link_to "javaws command line reference", "http://docs.oracle.com/javase/1.5.0/docs/guide/javaws/developersguide/javaws.html" %>
  -->
  Once you have started DoMosaics, you will probably want to start with a set of fasta sequences,
  run the annotator (against <%= link_to "InterPro", "http://www.ebi.ac.uk/interpro/" %>) to annotate domains, and then associate the resulting domain architectures 
  to leafs of a tree. A crude tree can be calculated using DoMosaics, but we recommend using proper software for that
  (eg. <%= link_to "RaxML", "http://icwww.epfl.ch/~stamatak/index-Dateien/Page443.htm" %> or <%= link_to 'FastTree', "http://www.microbesonline.org/fasttree/" %> ).
   For more information on how to do what, visit the <%= link_to 'documentation', page_path("docs/index.html") %>.</p>
  </div>
  <p style='float:right;'><a class='btn btn-small btn-info' href='#top'>top <i class="icon-arrow-up"></i></a></p>
  <br />
  <br />
  </section>

  <a name='changelog'></a>
  <section='changelog'>
  <h3>Changelog</h3>
  <hr />
  <div style='text-align: justify;'>
  We have have been working hard at cleaning up DoMosaics for final release. We have fixed a number of annoying bugs and have
  added a couple of new features (and bugs).
  <br />
  <br />
  <ul>
    <span class="label label-info">REVISION 1.79</span> (current release candidate) 
    <ul>
      <li>Lots of bugfixes</li>
      <li>Cleaned up UI and wizards</li>
    </ul>
      <i class="icon-warning-sign"></i> Known issues:
      <ul>
        <li>the netbeans wizard API used in all DoMosaics wizards does not work properly with OpenJDK 1.6.0 (java-1.6.0-openjdk-amd64), which
        leads to freezes in all wizards (e.g. when creating a workspace). We do not know the reason for this, but an upgrade to 1.7
        (<a href="http://openjdk.java.net/install/">java-1.7.0-openjdk-amd64</a>) fixes the issue.</li>
        <li>Some systems present problems with windows stacking (e.g. a pop-up window opens, but remains
          under the parent window). This can give the impression that DoMosaics has frozen
          (as the modal window in the background is waiting for input). We are working on fixing this issue.</li>
        <li>A few users have reported issues with running interpro scans (in which the scan terminates right after submission,
          even if domains can be found in the query sequence). We have not been able to reproduce this issue. Please
          drop us an email if you experience this (and include the fasta file).</li>
      </ul>
     <br />
    <span class="label label-info">REVISION 1.78</span> (current beta release) 
      <ul>
        <li>Complete overhaul of workspace management</li>
        <li>Updated iprscan to reflect changes to EBI interproscan API</li>
        <li>Angstd now supports all InterProScan methods (Superfam, Pfam, SMART, Panther, ...)</li>
        <li>Updated local HMMSCAN and HMMPRESS interfaces</li>
        <li>Incorporated GO mappings</li>
        <li>Included CODD procedure to allow for context dependent annotation 
            (see also <%= link_to "PMID:19786484", "http://www.ncbi.nlm.nih.gov/pubmed/19786484" %>)
        </li>
        <li>Cleaned up overlap resolution procedure (mostly GUI related)</li>
        <li>Various updates to the user interface</li>
        <li>...</li>
      </ul>
     <i class="icon-warning-sign"></i> Known issues:
     <ul>
       <li>Tree creation: there are issues when creating a tree using ClustalW (@EBI)</li> 
       <li>Job management: submitted jobs do not cancel properly upon abort (in some special cases)</li> 
     </ul>
     <br />
     <span class='label label-info'>REVISION 1.68</span> (first public release) <br />
     <i class="icon-warning-sign"></i> Known issues:
     <ul>
       <li>Bug in SwingWorker for Java SDK versions 1.6.0_18 - 1.6.0_20; InterProScan does not work properly.
       We recommend updating to the newest Java version.</li>
     </ul>
   </div>
  <p style='float:right;'><a class='btn btn-small btn-info' href='#top'>top <i class="icon-arrow-up"></i></a></p>
  <br />
  <br />
  </section>
  <br />
  <a name='faq'></a>
  <section id='faq'>
  <h3>Frequently asked questions</h3>
  <hr />
  <ul>

    <li>
      <em>When I start the application the JNLP file is displayed (and not started)</em>
      <p>It is likely that your browser is not set up to handle JNLP files. If so, when you start DoMosaics you will see a dialog asking you what to do with the file.
        In the window, click on Open with, select the javaws executable (depending on your operating system, the name can be different) and press OK.
        If the "open with" option does not display the Java Web Start executable, map the .jnlp file to Java Web Start manually. This procedure
        differs for different browsers - best google the right solution for your OS/Browser setup. Get in touch if the problem
        is persistent.</p>
    </li>

    <li>
    <em>How is DoMosaics licensed?</em>
    <p style='text-align:justify'>We will release DoMosaics using some <b>open source license</b>, and the code will be
    deposited in <b>github</b> once we have reached the first stable release. Until that point, drop us an email and
    we can set you up with access to our git repo.
    </p>
    </li>


    <li>
    <em>I am using DoMosaics under Windows...</em>
    <p style='text-align:justify;'>If you are having problems under Windows, <a href="#contact">contact</a> us with some details and will get back to you.</p>
    </li>

    <li>
    <em>When I start DoMosaics I get "The default workspace is currently in use ..." and the remove button is not working </em>
    <p style='text-align:justify;'>This can happen when DoMosaics crashes violently, and can not clean up after itself. Navigate to the workspace folder you created
    when you started DoMosaics the first time (default is USER_HOME/.angstd-workspace) and remove the .lock file.</p>
    </li>
    <li>
    <em>How do I get started? Is there a manual?</em>
    <p style='text-align:justify;'>
    Yes. There is a (currently growing) manual, which can be found <%= link_to 'here', 'http://domosdocs.uni-muenster.de' %>.
    To get you started, we have added an example data set for users to use a bit prior 
    'production' use (which can be found under 'Help'). In general, it is probably easiest to
    start with a set of protein sequences (fasta format), and load them into DoMosaics (File -> Manage Projects
    -> Create new Project (name, next) -> choose sequence -> select sequence file (fasta))
    Once the view is loaded, run a search for domains using InterProScan (Actions -> InterPro) to create a domain view.</p>
    </li>
    
    <li>
    <em>I am getting a java error: </em>
    <pre>Exception in thread "main" java.lang.OutOfMemoryError: Java heap space</pre>
    <p style='text-align:justify;'>This indicates that the <%= link_to 'Java virtual machine', "http://en.wikipedia.org/wiki/Java_virtual_machine" %>
    has run out of memory. Re-download DoMosaics, but choose a larger JVM size from the drop down menu above. <b>Note</b>
      that while we have used DoMosaics with genome-sized datasets, some operations are not feasible for such large datasets.
    </li>

    <li>
    <em>Apparently, my question is not frequently asked...</em>
    <p>Please feel free to <a href="contact">contact</a> us</p>
    </li>

  </ul>
  <p style='float:right;'><a class='btn btn-small btn-info' href='#top'>top <i class="icon-arrow-up"></i></a></p>
  <br />
  <br />
  </section>
  <br />

  <section id='referencing'>
  <h3>How do I reference DoMosaics in my work?</h3>
  <hr />
  <p style='text-align:justify;'>
  A manuscript decribing DoMosaics has been submitted. To date, we and others have used DoMosaics in a number of publications, and have
  (for example, see <%= link_to "PMID:20075255", "http://www.ncbi.nlm.nih.gov/pubmed/20075255" %> 
  and <%= link_to "PMID:2093230", "http://www.ncbi.nlm.nih.gov/pubmed/20932300" %>).</p>
  <p style='text-align:justify;'> <b>Long story short</b>: Please consult this site before publishing. For the time being, if your journal
  supports URL citations, please cite</p>
  <p style='text-align:center;'><%= link_to "http://www.domosaics.uni-muenster.de","http://www.domsaics.uni-muenster.de" %></p>
  <p style='float:right;'><a class='btn btn-small btn-info' href='#top'>top <i class="icon-arrow-up"></i></a></p>
  <br />
  <br />
  </section>
  <br />



  <a name='contact'></a>
  <section id='contact'>
  <h3>Contact</h3>
  <hr />
  <p style='text-align:justify;'>DoMosaics is currently being developed by <a href="http://ieb.uni-muenster.de/bioinf/people/moore">Andrew Moore</a> and
  <a href='http://ieb.uni-muenster.de/bioinf/people/terrapon'>Nicolas Terrapon</a>. Lots of inital development was done by Andreas Held (a Perl-TK version was developed by
  January Weiner).</p>
  <address>
    <b>Dr. Andrew D. Moore</b> <br />
    Evolutionary Bioinformatics Group<br />
    Institute for Evolution and Biodiversity <br />
    Huefferstr. 1, 48147 Muenster, Germany<br />
    <a href='http://ieb.uni-muenster.de/bioinf'>http://ieb.uni-muenster.de/bioinf</a><br />
    radmoore@uni-muenster.de<br />
  </address>
  </section>
  <p style='float:right;'><a class='btn btn-small btn-info' href='#top'>top <i class="icon-arrow-up"></i></a></p>
  <br />
  <br />
  <br />
  <br />
  <br />
  <hr />
  <div class='row'>
    <div class='span6'>
      <%= link_to (image_tag '/assets/logo-opensource.png', :alt=>'Open Source Initiative'), 'http://opensource.org' %>
    </div>
  </div>
</div>

